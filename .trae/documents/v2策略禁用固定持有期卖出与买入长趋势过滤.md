## 目标
- v2 版本不执行固定持有期（如 5 天）到期卖出；仅由止盈/止损/退市/回测结束触发平仓。
- v2 版本开仓过滤：当日收盘价低于长期多空线 `long_trend`，不买入并顺延到下一个推荐标的；推荐标的必须满足 `predicted_return > 0`。
- v1 保持现状，不改动。

## 代码改动
### 1. v2 禁用到期强平
- 位置：`src/backtest_engine.py::run_backtest`（约 409-414 行）
- 修改：仅在 `self.variant == 'v1'` 时执行 `horizon_expiry` 强平；`v2` 跳过该分支。

### 2. v2 买入过滤与顺延
- 位置：`src/backtest_engine.py::run_backtest` 候选与开仓分支（约 439-475 行）
- 步骤：
  - 候选初筛：`daily_predictions.sort_values('predicted_return', desc)`；过滤掉已持有与 `predicted_return <= 0` 的条目。
  - 迭代候选列表，逐个尝试：
    - 通过 `get_daily_prices(symbol, current_date_str, current_date_str)` 获取当日 `close` 与 `long_trend`。
    - 若 `long_trend` 缺失或 `close < long_trend`，则跳过该候选，顺延到下一个；否则允许开仓。
    - 仅在 `self.variant == 'v2'` 执行上述过滤；`v1` 不进行长趋势买入过滤。
  - 继续迭代直到填满 `slots_to_open` 或耗尽候选。

### 3. CLI 保持不变
- 使用现有 `--dynamic-variant` 指定 `v1|v2`，无需新增参数。

## 验证
- 更新并运行 `src/smoke_backtest.py`：
  - 构造候选集包含一个 `predicted_return <= 0` 的标的以验证被过滤。
  - 构造一日 `close < long_trend` 验证 v2 跳过并顺延到下一个候选；v1 不受该过滤影响。
  - 验证 v2 在持有期内不因 horizon 到期卖出，仅在最终 `backtest_end` 结算。

## 兼容与性能
- 候选数量有限，对每候选一次日线读取开销可接受。
- 若 `long_trend` 缺失则视为不满足买入条件并顺延，确保策略稳健；v1 不受影响。